
#ifndef _CHRONOTRIX_FRWK_WINDOW_HPP_
#define _CHRONOTRIX_FRWK_WINDOW_HPP_

#include <ct/config/types.hpp>
#include <ct/core/utils/noncopyable.hpp>
#include <ct/core/types/type_traits.hpp>
#include <ct/math/rect.hpp>
#include <ct/math/vec.hpp>
#include <ct/platform/export.hpp>
#include <ct/platform/window_handle.hpp>
#include <ct/platform/window_properties.hpp>
#include <ct/platform/window_style.hpp>

namespace ct {

	namespace internal {
		class WindowImpl;
	}

	////////////////////////////////////////////////////////////
	/// @brief Represents window instance
	///
	////////////////////////////////////////////////////////////
	class CT_PLATFORM_API Window : NonCopyable {

	protected:
		internal::WindowImpl * impl; ///< Window implementation
		////////////////////////////////////////////////////////////
		/// @brief Constructs a window instance
		///
		/// @param impl Internal window implementation
		///
		////////////////////////////////////////////////////////////
		Window(internal::WindowImpl * impl);

	public:
		////////////////////////////////////////////////////////////
		/// @brief Constructor
		/// To create an window use Window::create
		///
		////////////////////////////////////////////////////////////
		Window();

		////////////////////////////////////////////////////////////
		/// @brief Move constructor
		///
		/// @param other Window
		///
		////////////////////////////////////////////////////////////
		explicit Window(Window && other);

		////////////////////////////////////////////////////////////
		/// @brief Destroy the Window instance
		///
		////////////////////////////////////////////////////////////
		virtual ~Window();

		////////////////////////////////////////////////////////////
		/// @brief Get the native window handle
		///
		/// @return WindowHandle
		///
		////////////////////////////////////////////////////////////
		WindowHandle get_handle() const;

		////////////////////////////////////////////////////////////
		/// @brief Get window's inner frame in screen coordinates
		///
		/// @return Size of the window content
		///
		////////////////////////////////////////////////////////////
		recti get_content_frame() const;

		////////////////////////////////////////////////////////////
		/// @brief Get window's frame rectangle in screen coordinates
		///
		/// The dimensions of window frame includes title bar and
		/// any other offset attribute (like borders, shadow radius...)
		///
		/// @return Window's frame
		///
		////////////////////////////////////////////////////////////
		recti get_frame() const;

		////////////////////////////////////////////////////////////
		/// @brief Get window's position in pixels
		///
		/// The position are relative to the upper-left
		/// corner of the screen.
		///
		/// @return Position of the window
		///
		////////////////////////////////////////////////////////////
		vec2i get_position() const;

		////////////////////////////////////////////////////////////
		/// @brief Get window's content size in pixels
		///
		/// Does not include title bar size or offset attributes.
		/// It only considered the inner frame size of the window.
		///
		/// @return Size of the window
		///
		////////////////////////////////////////////////////////////
		vec2u get_size() const;

		////////////////////////////////////////////////////////////
		/// @brief Get window title
		///
		/// @return Window title name
		///
		////////////////////////////////////////////////////////////
		cstr get_title() const;

		////////////////////////////////////////////////////////////
		/// @brief Check whether or not the window is visible on screen
		///
		/// @return True is visible to the user otherwise false
		///
		////////////////////////////////////////////////////////////
		bool is_visible() const;

		bool is_open() const;

		////////////////////////////////////////////////////////////
		/// @brief Set position and size of the window frame
		///
		/// @param frame Window's frame
		///
		////////////////////////////////////////////////////////////
		void set_frame(const recti & frame);

		////////////////////////////////////////////////////////////
		/// @brief Set the window position
		///
		/// @param position New position of the window
		///
		////////////////////////////////////////////////////////////
		void set_position(const vec2i & position);

		////////////////////////////////////////////////////////////
		/// @brief Set the window position
		///
		/// @param x Horizontal screen coordinate
		/// @param y Vertical screen coordinate
		//
		////////////////////////////////////////////////////////////
		void set_position(const i32 & x, const i32 & y);

		////////////////////////////////////////////////////////////
		/// @brief Set the window content size
		///
		/// @param x Window width
		/// @param y Window height
		//
		////////////////////////////////////////////////////////////
		void set_size(const vec2u & size);

		////////////////////////////////////////////////////////////
		/// @brief Set window visibility
		///
		/// @param visible Visibility flag
		///
		////////////////////////////////////////////////////////////
		void set_visible(bool visible);

		////////////////////////////////////////////////////////////
		/// @brief Set the window title
		///
		/// @param title UTF8 encoded window title
		///
		////////////////////////////////////////////////////////////
		void set_title(cstr title);

		////////////////////////////////////////////////////////////
		/// @brief Closes the window immediately and release internal pointers
		///
		////////////////////////////////////////////////////////////
		void close();

		// CT_PLATFORM_API void create();

		void create(const WindowProperties & properties);
		void create(u32 width,
					u32 height,
					cstr title,
					u32 style = WindowStyle::Default);

	protected:
		static internal::WindowImpl *
		create_window_impl(const WindowProperties & properties);
	};
} // namespace ct

#endif
